<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.5.0_14) on Mon Dec 17 23:22:10 EST 2007 -->
<TITLE>
QueryMapper
</TITLE>

<META NAME="keywords" CONTENT="org.firewaterframework.mappers.jdbc.QueryMapper class">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    parent.document.title="QueryMapper";
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../org/firewaterframework/mappers/jdbc/package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../index-files/index-1.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../org/firewaterframework/mappers/jdbc/PivotTreeBuilder.html" title="class in org.firewaterframework.mappers.jdbc"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../org/firewaterframework/mappers/jdbc/UpdateMapper.html" title="class in org.firewaterframework.mappers.jdbc"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../index.html?org/firewaterframework/mappers/jdbc/QueryMapper.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="QueryMapper.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
org.firewaterframework.mappers.jdbc</FONT>
<BR>
Class QueryMapper</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../../../resources/inherit.gif" ALT="extended by ">org.firewaterframework.mappers.Mapper
      <IMG SRC="../../../../resources/inherit.gif" ALT="extended by "><A HREF="../../../../org/firewaterframework/mappers/jdbc/JDBCMapper.html" title="class in org.firewaterframework.mappers.jdbc">org.firewaterframework.mappers.jdbc.JDBCMapper</A>
          <IMG SRC="../../../../resources/inherit.gif" ALT="extended by "><B>org.firewaterframework.mappers.jdbc.QueryMapper</B>
</PRE>
<HR>
<DL>
<DT><PRE>public class <B>QueryMapper</B><DT>extends <A HREF="../../../../org/firewaterframework/mappers/jdbc/JDBCMapper.html" title="class in org.firewaterframework.mappers.jdbc">JDBCMapper</A></DL>
</PRE>

<P>
This class is responsible for servicing GET Rest requests against a back-end relational
 database (through JDBC).  It is responsible for executing a configured query template and returning
 it as a REST Response.  Note that currently this Mapper (and all JDBCMappers) return only
 <CODE>DocumentResponse</CODE>s - which means that the only response type when using these
 Mappers are XML documents.
<P>

<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../../org/firewaterframework/mappers/jdbc/PivotTreeBuilder.html" title="class in org.firewaterframework.mappers.jdbc"><CODE>PivotTreeBuilder</CODE></A></DL>
<HR>

<P>
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/firewaterframework/mappers/jdbc/QueryMapper.html#defaultPageSize">defaultPageSize</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected static&nbsp;org.apache.commons.logging.Log</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/firewaterframework/mappers/jdbc/QueryMapper.html#log">log</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/firewaterframework/mappers/jdbc/QueryMapper.html#pageCountPivot">pageCountPivot</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected static&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/firewaterframework/mappers/jdbc/QueryMapper.html#pageCountQuery">pageCountQuery</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/firewaterframework/mappers/jdbc/QueryMapper.html#pageTokenFragment">pageTokenFragment</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/firewaterframework/mappers/jdbc/QueryMapper.html#pageWindowSize">pageWindowSize</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="../../../../org/firewaterframework/mappers/jdbc/PivotTreeBuilder.html" title="class in org.firewaterframework.mappers.jdbc">PivotTreeBuilder</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/firewaterframework/mappers/jdbc/QueryMapper.html#pivotTreeBuilder">pivotTreeBuilder</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/firewaterframework/mappers/jdbc/QueryMapper.html#query">query</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;<A NAME="fields_inherited_from_class_org.firewaterframework.mappers.jdbc.JDBCMapper"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Fields inherited from class org.firewaterframework.mappers.jdbc.<A HREF="../../../../org/firewaterframework/mappers/jdbc/JDBCMapper.html" title="class in org.firewaterframework.mappers.jdbc">JDBCMapper</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="../../../../org/firewaterframework/mappers/jdbc/JDBCMapper.html#template">template</A></CODE></TD>
</TR>
</TABLE>
&nbsp;<A NAME="fields_inherited_from_class_org.firewaterframework.mappers.Mapper"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Fields inherited from class org.firewaterframework.mappers.Mapper</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>fields</CODE></TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../org/firewaterframework/mappers/jdbc/QueryMapper.html#QueryMapper()">QueryMapper</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/firewaterframework/mappers/jdbc/QueryMapper.html#addPagingTags(org.dom4j.Document, java.lang.String, java.lang.Integer, java.lang.Integer, java.lang.String)">addPagingTags</A></B>(org.dom4j.Document&nbsp;resultDOM,
              java.lang.String&nbsp;pageCountQueryString,
              java.lang.Integer&nbsp;pageNum,
              java.lang.Integer&nbsp;pageSize,
              java.lang.String&nbsp;resourceURL)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/firewaterframework/mappers/jdbc/QueryMapper.html#buildPageURL(int, java.lang.String)">buildPageURL</A></B>(int&nbsp;pageNum,
             java.lang.String&nbsp;resourceURL)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/firewaterframework/mappers/jdbc/QueryMapper.html#getDefaultPageSize()">getDefaultPageSize</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/firewaterframework/mappers/jdbc/QueryMapper.html#getPageCountPivot()">getPageCountPivot</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.lang.Integer</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/firewaterframework/mappers/jdbc/QueryMapper.html#getPageNum(java.util.Map)">getPageNum</A></B>(java.util.Map&nbsp;argMap)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.lang.Integer</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/firewaterframework/mappers/jdbc/QueryMapper.html#getPageSize(java.util.Map)">getPageSize</A></B>(java.util.Map&nbsp;argMap)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/firewaterframework/mappers/jdbc/QueryMapper.html#getPageWindowSize()">getPageWindowSize</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../org/firewaterframework/mappers/jdbc/PivotTreeBuilder.html" title="class in org.firewaterframework.mappers.jdbc">PivotTreeBuilder</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/firewaterframework/mappers/jdbc/QueryMapper.html#getPivotTreeBuilder()">getPivotTreeBuilder</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/firewaterframework/mappers/jdbc/QueryMapper.html#getQuery()">getQuery</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;org.firewaterframework.rest.Response</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/firewaterframework/mappers/jdbc/QueryMapper.html#handle(org.firewaterframework.rest.Request)">handle</A></B>(org.firewaterframework.rest.Request&nbsp;request)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Handle a REST Request by querying a back-end relational database.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/firewaterframework/mappers/jdbc/QueryMapper.html#setDefaultPageSize(int)">setDefaultPageSize</A></B>(int&nbsp;defaultPageSize)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This class handles paging to allow for handling of large result sets.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/firewaterframework/mappers/jdbc/QueryMapper.html#setPageCountPivot(java.lang.String)">setPageCountPivot</A></B>(java.lang.String&nbsp;pageCountPivot)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This is the column who's distinct elements will be counted to get the total number
 of elements in the result set.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/firewaterframework/mappers/jdbc/QueryMapper.html#setPageWindowSize(int)">setPageWindowSize</A></B>(int&nbsp;pageWindowSize)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The page window size is the number of pages to return in the <pages> XML tag
 when paging is enabled.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/firewaterframework/mappers/jdbc/QueryMapper.html#setPivotTreeBuilder(org.firewaterframework.mappers.jdbc.PivotTreeBuilder)">setPivotTreeBuilder</A></B>(<A HREF="../../../../org/firewaterframework/mappers/jdbc/PivotTreeBuilder.html" title="class in org.firewaterframework.mappers.jdbc">PivotTreeBuilder</A>&nbsp;pivotTreeBuilder)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 This class collaborates with the PivotTreeBuilder to construct an XML document based
 on the result set of the query.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/firewaterframework/mappers/jdbc/QueryMapper.html#setQuery(java.lang.String)">setQuery</A></B>(java.lang.String&nbsp;query)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The QueryMapper uses the <a href="http://www.stringtemplate.org/">StringTemplate</a> template
 engine to assemble the SQL queries for execution.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_org.firewaterframework.mappers.jdbc.JDBCMapper"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class org.firewaterframework.mappers.jdbc.<A HREF="../../../../org/firewaterframework/mappers/jdbc/JDBCMapper.html" title="class in org.firewaterframework.mappers.jdbc">JDBCMapper</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="../../../../org/firewaterframework/mappers/jdbc/JDBCMapper.html#setDataSource(javax.sql.DataSource)">setDataSource</A></CODE></TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_org.firewaterframework.mappers.Mapper"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class org.firewaterframework.mappers.Mapper</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>bind, getDataBinder, setFields</CODE></TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Field Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="log"><!-- --></A><H3>
log</H3>
<PRE>
protected static final org.apache.commons.logging.Log <B>log</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="pageCountQuery"><!-- --></A><H3>
pageCountQuery</H3>
<PRE>
protected static final java.lang.String <B>pageCountQuery</B></PRE>
<DL>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../../constant-values.html#org.firewaterframework.mappers.jdbc.QueryMapper.pageCountQuery">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="query"><!-- --></A><H3>
query</H3>
<PRE>
protected java.lang.String <B>query</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="pivotTreeBuilder"><!-- --></A><H3>
pivotTreeBuilder</H3>
<PRE>
protected <A HREF="../../../../org/firewaterframework/mappers/jdbc/PivotTreeBuilder.html" title="class in org.firewaterframework.mappers.jdbc">PivotTreeBuilder</A> <B>pivotTreeBuilder</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="defaultPageSize"><!-- --></A><H3>
defaultPageSize</H3>
<PRE>
protected int <B>defaultPageSize</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="pageWindowSize"><!-- --></A><H3>
pageWindowSize</H3>
<PRE>
protected int <B>pageWindowSize</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="pageCountPivot"><!-- --></A><H3>
pageCountPivot</H3>
<PRE>
protected java.lang.String <B>pageCountPivot</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="pageTokenFragment"><!-- --></A><H3>
pageTokenFragment</H3>
<PRE>
protected java.lang.String <B>pageTokenFragment</B></PRE>
<DL>
<DL>
</DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="QueryMapper()"><!-- --></A><H3>
QueryMapper</H3>
<PRE>
public <B>QueryMapper</B>()</PRE>
<DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="handle(org.firewaterframework.rest.Request)"><!-- --></A><H3>
handle</H3>
<PRE>
<FONT SIZE="-1">@Transactional(readOnly=true,
               isolation=READ_COMMITTED)
</FONT>public org.firewaterframework.rest.Response <B>handle</B>(org.firewaterframework.rest.Request&nbsp;request)</PRE>
<DL>
<DD>Handle a REST Request by querying a back-end relational database.

 Before the query is executed, the Request arguments are 'bound' to an
 intermediate Map.  This gives the opportunity to do validation and
 type conversions.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE>handle</CODE> in class <CODE>org.firewaterframework.mappers.Mapper</CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>request</CODE> - incoming REST GET Request
<DT><B>Returns:</B><DD>a DocumentResponse with the XML document of the result set<DT><B>See Also:</B><DD><CODE>MapDataBinder</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="buildPageURL(int, java.lang.String)"><!-- --></A><H3>
buildPageURL</H3>
<PRE>
protected java.lang.String <B>buildPageURL</B>(int&nbsp;pageNum,
                                        java.lang.String&nbsp;resourceURL)</PRE>
<DL>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>pageNum</CODE> - <DD><CODE>resourceURL</CODE> - 
<DT><B>Returns:</B><DD></DL>
</DD>
</DL>
<HR>

<A NAME="addPagingTags(org.dom4j.Document, java.lang.String, java.lang.Integer, java.lang.Integer, java.lang.String)"><!-- --></A><H3>
addPagingTags</H3>
<PRE>
protected void <B>addPagingTags</B>(org.dom4j.Document&nbsp;resultDOM,
                             java.lang.String&nbsp;pageCountQueryString,
                             java.lang.Integer&nbsp;pageNum,
                             java.lang.Integer&nbsp;pageSize,
                             java.lang.String&nbsp;resourceURL)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getPageNum(java.util.Map)"><!-- --></A><H3>
getPageNum</H3>
<PRE>
protected java.lang.Integer <B>getPageNum</B>(java.util.Map&nbsp;argMap)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getPageSize(java.util.Map)"><!-- --></A><H3>
getPageSize</H3>
<PRE>
protected java.lang.Integer <B>getPageSize</B>(java.util.Map&nbsp;argMap)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getQuery()"><!-- --></A><H3>
getQuery</H3>
<PRE>
public java.lang.String <B>getQuery</B>()</PRE>
<DL>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="setQuery(java.lang.String)"><!-- --></A><H3>
setQuery</H3>
<PRE>
public void <B>setQuery</B>(java.lang.String&nbsp;query)</PRE>
<DL>
<DD>The QueryMapper uses the <a href="http://www.stringtemplate.org/">StringTemplate</a> template
 engine to assemble the SQL queries for execution.  The Request arguments are made available
 to the template engine when processing the SQL templates, as well as other configuration
 parameters.  This allows for very flexible and powerful SQL processing, without resorting
 to SQL generation.  It is easy to set up filtering
 and sorting using a combination of Request arguments and StringTemplated queries.  For
 example, assume we have the REST URL "/users?sort=city&region=14", then in our SQL template we can
 access the argument using a StringTemplate variable:
 <p>
 <code><pre>
        SELECT u.id as user, u.name, u.city, u.state, u.zip
        FROM user u
        WHERE u.region_id = $region$
        ORDER BY $sort$
 </pre></code>

 <p>
 StringTemplate offers rich collection primitives and basic conditionals.  The problem
 with the above query is if the Request arguments 'sort' and 'region' aren't supplied,
 we would get a runtime SQL exception.  Use StringTemplate to provide default values:

 <p>
 <code><pre>
        SELECT u.id as user, u.name, u.city, u.state, u.zip
        FROM user u
        $if(region)$
          WHERE u.region_id = $region$
        $endif$
        ORDER BY
          $if(sort)$
              u.$sort$
          $else$
              u.id
 </pre></code>
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>query</CODE> - the source for the StringTemplate query for fetching result sets for this mapper</DL>
</DD>
</DL>
<HR>

<A NAME="getPivotTreeBuilder()"><!-- --></A><H3>
getPivotTreeBuilder</H3>
<PRE>
public <A HREF="../../../../org/firewaterframework/mappers/jdbc/PivotTreeBuilder.html" title="class in org.firewaterframework.mappers.jdbc">PivotTreeBuilder</A> <B>getPivotTreeBuilder</B>()</PRE>
<DL>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="setPivotTreeBuilder(org.firewaterframework.mappers.jdbc.PivotTreeBuilder)"><!-- --></A><H3>
setPivotTreeBuilder</H3>
<PRE>
public void <B>setPivotTreeBuilder</B>(<A HREF="../../../../org/firewaterframework/mappers/jdbc/PivotTreeBuilder.html" title="class in org.firewaterframework.mappers.jdbc">PivotTreeBuilder</A>&nbsp;pivotTreeBuilder)</PRE>
<DL>
<DD><p>
 This class collaborates with the PivotTreeBuilder to construct an XML document based
 on the result set of the query.  Because of the flat nature of SQL result sets, and the
 typically desired heirarchical XML document Response, this class expects that it's query
 will return a 'pivotTree' style response.  This means that when writing queries for
 this Mapper, you need to select all properties for all joined tables and order the
 result set based on the 'pivot' columns (ie. the id columns) to reflect the tree-structure
 of the resultant XML document.  This sounds complicated, but it's easier to explain with
 an example :)
 <p>
 Assume you have the following Tables in your database:
 <p>
 <table border="1">
 <caption>Owner Table</caption>
 <tr><td><b>id</b><td><b>name</b><td><b>city</b></td><td><b>state</b></td><td><b>zip</b></td></tr>
 <tr><td>1</td><td>Tim Spurway</td><td>New York</td><td>NY</td><td>10002</td></tr>
 <tr><td>2</td><td>Joe Smith</td><td>Los Angeles</td><td>CA</td><td>90210</td></tr>
 <tr><td>3</td><td>Jane Doe</td><td>New York</td><td>NY</td><td>10012</td></tr>
 </table>

 <p>
 <table border="1">
 <caption>Pet Table</caption>
 <tr><td><b>id</b></td><td><b>name</b></td><td><b>owner_id</b></td></tr>
 <tr><td>1</td><td>Trixie</td><td>1</td></tr>
 <tr><td>2</td><td>Mixie</td><td>2</td></tr>
 <tr><td>3</td><td>Spot</td><td>2</td></tr>
 <tr><td>4</td><td>Herbie</td><td>2</td></tr>
 </table>

 <p>
 A SQL select statement to return all owners and their pets in 'pivotTree' style would
 look like this:
 <p>
 <code><pre>
 SELECT o.id as owner, o.name as owner_name, o.city, o.state, o.zip, p.id as pet, p.name as pet_name
 FROM owner o
 LEFT OUTER JOIN pet p on o.id = p.owner_id
 ORDER BY o.id
 </pre></code>

 <p>
 The point of using this pivotTree scheme is to fetch all related objects in a single
 query.  The above query will return, on each row, all information for both owners and
 their pets.  Notice that we have two 'pivot' columns (owner and pet) in the result set.
 These columns are used by the <A HREF="../../../../org/firewaterframework/mappers/jdbc/PivotTreeBuilder.html" title="class in org.firewaterframework.mappers.jdbc"><CODE>PivotTreeBuilder</CODE></A>
 to build the tree struture.  Also note the 'LEFT OUTER JOIN' on the pet table.  This
 will ensure that owners with no pets will also be present in the result set.  Also
 note that we are ordering the result set on the 'owner' pivot column.  The PivotTreeBuilder
 uses this ordering to know when to create a new XML node for the result document.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>pivotTreeBuilder</CODE> - </DL>
</DD>
</DL>
<HR>

<A NAME="getDefaultPageSize()"><!-- --></A><H3>
getDefaultPageSize</H3>
<PRE>
public int <B>getDefaultPageSize</B>()</PRE>
<DL>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="setDefaultPageSize(int)"><!-- --></A><H3>
setDefaultPageSize</H3>
<PRE>
public void <B>setDefaultPageSize</B>(int&nbsp;defaultPageSize)</PRE>
<DL>
<DD>This class handles paging to allow for handling of large result sets.  This feature will
 print a set of XML tags at the end of the Response that will 'point' to other pages in
 the result set.  To enable this feature, set the defaultPageSize of the Mapper to a value
 greater than zero, then append the special template variable $page_token$ to the pivot
 dimension that you want to page on.  For example, in our query above, if we wanted to
 limit the paging to 10 users per page, we would set the defaultPageSize of our Mapper
 to 10, then modify the query in the following manner:

 <p>
 <code><pre>
 SELECT o.id as owner, o.name as owner_name, o.city, o.state, o.zip, p.id as pet, p.name as pet_name
 FROM (SELECT id, name, city, state, zip FROM owner $page_token$) as o
 LEFT OUTER JOIN pet p on o.id = p.owner_id
 ORDER BY o.id
 </pre></code>

 <p>
 We use a nested SELECT here to indicate that the paging should limit the results on the
 owner pivot.  The <code>$page_token$</code> is simply translated into a LIMIT statement (which ensures
 database independence) over a set of page count calculations performed by the Mapper.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>defaultPageSize</CODE> - the number of rows to include in each page of paged output (set to 0 to turn off paging)</DL>
</DD>
</DL>
<HR>

<A NAME="getPageWindowSize()"><!-- --></A><H3>
getPageWindowSize</H3>
<PRE>
public int <B>getPageWindowSize</B>()</PRE>
<DL>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="setPageWindowSize(int)"><!-- --></A><H3>
setPageWindowSize</H3>
<PRE>
public void <B>setPageWindowSize</B>(int&nbsp;pageWindowSize)</PRE>
<DL>
<DD>The page window size is the number of pages to return in the <pages> XML tag
 when paging is enabled.  This is to limit the result set size for very large
 result sets, when even the number of pages is very large.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>pageWindowSize</CODE> - the maximum number of pages allowed in the <pages> tag</DL>
</DD>
</DL>
<HR>

<A NAME="getPageCountPivot()"><!-- --></A><H3>
getPageCountPivot</H3>
<PRE>
public java.lang.String <B>getPageCountPivot</B>()</PRE>
<DL>
<DD><DL>

<DT><B>Returns:</B><DD>the column in the result set to count the total number of pivot results.  Defaults
 to the pivotColumn in the top level PivotTreeBuilder of this mapper.</DL>
</DD>
</DL>
<HR>

<A NAME="setPageCountPivot(java.lang.String)"><!-- --></A><H3>
setPageCountPivot</H3>
<PRE>
public void <B>setPageCountPivot</B>(java.lang.String&nbsp;pageCountPivot)</PRE>
<DL>
<DD>This is the column who's distinct elements will be counted to get the total number
 of elements in the result set.  This is used by the pageCountQuery to calculate the
 total number of results in the result set so that the <pages> structure can be built
 properly.  The default value for this property is the pivotColumn of the mapper's
 pivotTreeBuilder - which is usually the correct setting for this.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>pageCountPivot</CODE> - the column name in the query result set used for counting the number of
 pivot objects in the result set.</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../org/firewaterframework/mappers/jdbc/package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../index-files/index-1.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../org/firewaterframework/mappers/jdbc/PivotTreeBuilder.html" title="class in org.firewaterframework.mappers.jdbc"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../org/firewaterframework/mappers/jdbc/UpdateMapper.html" title="class in org.firewaterframework.mappers.jdbc"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../index.html?org/firewaterframework/mappers/jdbc/QueryMapper.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="QueryMapper.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>

</BODY>
</HTML>
